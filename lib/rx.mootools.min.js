/**
* Copyright 2011 Microsoft Corporation
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
(function(i){var j=i.Rx,k=j.Observable,f=k.createWithDisposable,m=j.Disposable.create,g=j.CompositeDisposable,h=j.RefCountDisposable,l=j.AsyncSubject,i=k.fromMooToolsEvent=function(a,b){return k.Create(function(c){var d=function(a){c.onNext(a)};a.addEvent(b,d);return function(){a.removeEvent(b,d)}})};Window.implement({addEventAsObservable:i});Document.implement({addEventAsObservable:i});Element.implement({addEventAsObservable:i});Elements.implement({addEventAsObservable:i});Events.implement({addEventAsObservable:i});
k.createMooToolsRequest=function(a){var b=new l,c,d;a.onSuccess=function(a,e){b.onNext({responseText:a,responseXML:e});b.onCompleted()};a.onFailure=function(a){b.onError({kind:"failure",xhr:a})};a.onException=function(a,e){b.onError({kind:"exception",headerName:a,value:e})};try{c=new Request(a),c.send()}catch(e){b.onError(e)}d=new h(m(function(){c&&c.cancel()}));return f(function(a){return new g(b.subscribe(a),d.getDisposable())})};Request.implement({toObservable:function(){var a=new l,b=this,c;b.addEvents({success:function(b,
n){a.onNext({responseXML:n,responseText:b});a.onCompleted()},failure:function(b){a.onError({kind:"failure",xhr:b})},exception:function(b,n){a.onError({kind:"exception",headerName:b,value:n})}});try{b.send()}catch(d){a.onError(d)}c=new h(m(function(){b.cancel()}));return f(function(b){return new g(a.subscribe(b),c.getDisposable())})}});k.createMooToolsJSONRequest=function(a){var b=new l,c,d;a.onSuccess=function(a,e){b.onNext({responseJSON:a,responseText:e});b.onCompleted()};a.onFailure=function(a){b.onError({kind:"failure",
xhr:a})};a.onException=function(a,e){b.onError({kind:"exception",headerName:a,value:e})};try{c=new Request(newOptions),c.send()}catch(e){b.onError(e)}d=new h(m(function(){c&&c.cancel()}));return f(function(a){return new g(b.subscribe(a),d.getDisposable())})};Request.JSON.implement({toObservable:function(){var a=new j.AsyncSubject,b=this,c;b.addEvents({success:function(b,c){a.onNext({responseJSON:b,responseText:c});a.onCompleted()},failure:function(b){a.onError({kind:"failure",xhr:b})},exception:function(b,
c){a.onError({kind:"exception",headerName:b,value:c})}});try{b.send()}catch(d){a.onError(d)}c=new h(m(function(){b.cancel()}));return f(function(b){return new g(a.subscribe(b),c.getDisposable())})}});k.createMooToolsHTMLRequest=function(a){var b=new l,c,d;a.onSuccess=function(a){b.onNext(a);b.onCompleted()};a.onFailure=function(a){b.onError({kind:"failure",xhr:a})};a.onException=function(a,c){b.onError({kind:"exception",headerName:a,value:c})};try{c=new Request.HTML(newOptions),c.send()}catch(e){b.onError(e)}d=
new h(j.Disposable.Create(function(){c&&c.cancel()}));return f(function(a){return new g(b.subscribe(a),d.getDisposable())})};Request.HTML.implement({toObservable:function(){var a=new l,b=this,c;b.addEvents({success:function(b){a.onNext(b);a.onCompleted()},failure:function(b){a.onError({kind:"failure",xhr:b})},exception:function(b,c){a.onError({kind:"exception",headerName:b,value:c})}});try{b.send()}catch(d){a.onError(d)}c=new h(m(function(){b.cancel()}));return f(function(b){return new g(a.subscribe(b),
c.getDisposable())})}});k.createMooToolsJSONPRequest=function(a){var b=new l,c,d;a.onSuccess=function(a){b.onNext(a);b.onCompleted()};a.onFailure=function(a){b.onError({kind:"failure",xhr:a})};a.onException=function(a,c){b.onError({kind:"exception",headerName:a,value:c})};try{c=new Request.JSONP(a),c.send()}catch(e){b.onError(e)}d=new h(m(function(){c&&c.cancel()}));return f(function(a){return new g(b.subscribe(a),d.getDisposable())})};Request.JSONP.implement({toObservable:function(){var a=new l,
b=this,c;b.addEvents({success:function(b){a.onNext(b);a.onCompleted()},failure:function(b){a.onError({kind:"failure",xhr:b})},exception:function(b,c){a.onError({kind:"exception",headerName:b,value:c})}});try{b.send()}catch(d){a.onError(d)}c=new h(disposablecCreate(function(){b.cancel()}));return f(function(b){return new g(a.subscribe(b),c.getDisposable())})}})})(this);